2025-10-07T08:57:30.763788Z ERROR security_compliance_cli::runner: ❌ runtime_004 FAILED: SSH critical security issues: Root login permitted - this is a critical security vulnerability
{
  "suite_name": "Runtime",
  "test_mode": "PreProduction",
  "total_tests": 8,
  "passed": 4,
  "failed": 1,
  "warnings": 2,
  "skipped": 1,
  "errors": 0,
  "duration": {
    "secs": 8,
    "nanos": 803513502
  },
  "timestamp": "2025-10-07T08:57:32.208911489Z",
  "system_info": {
    "uname": "Linux imx93-jaguar-eink-508fb2301742b979d60c4d9a4c0bf5c7 6.1.70-lmp-standard #1 SMP PREEMPT Tue May 28 10:24:04 UTC 2024 aarch64 aarch64 aarch64 GNU/Linux",
    "uptime": "08:57:24 up  1:08,  1 user,  load average: 0.13, 0.08, 0.05",
    "memory_info": "total        used        free      shared  buff/cache   available\nMem:            1931         126        1447          10         357        1770\nSwap:           1886           0        1886",
    "kernel_version": "6.1.70-lmp-standard",
    "os_release": "ID=lmp-dynamicdevices-headless\nNAME=\"Linux-microPlatform Dynamic Devices Headless\"\nVERSION=\"4.0.20-2156-94\"\nVERSION_ID=4.0.20-2156-94\nPRETTY_NAME=\"Linux-microPlatform Dynamic Devices Headless 4.0.20-2156-94\"\nHOME_URL=\"https://foundries.io/\"\nSUPPORT_URL=\"https://support.foundries.io/\"\nDEFAULT_HOSTNAME=\"imx93-jaguar-eink\"\nLMP_MACHINE=\"imx93-jaguar-eink\"\nLMP_FACTORY=\"dynamic-devices\"\nLMP_FACTORY_TAG=\"main-imx93-jaguar-eink\"\nIMAGE_ID=lmp-factory-image\nIMAGE_VERSION=2156\n",
    "foundries_registration": "Not Registered",
    "wireguard_status": "Not Available (module not loaded)",
    "disk_usage": "Root: 28G total, 1.4G used (6%)",
    "cpu_info": "2 cores, aarch64",
    "memory_usage": "1.9 GB total, 0.2 GB used (8.4%)",
    "power_governor": "No frequency scaling support"
  },
  "results": [
    {
      "test_id": "runtime_008",
      "test_name": "Read-Only Filesystem Protection",
      "category": "runtime",
      "status": "Passed",
      "message": "Read-only filesystem properly configured (5 protected areas)",
      "details": "Mount points:\ntmpfs on /run type tmpfs (rw,nosuid,nodev)\n/dev/mapper/mmcblk0p2_crypt on /sysroot type ext4 (rw,noatime,commit=60)\n/dev/mapper/mmcblk0p2_crypt on / type ext4 (rw,noatime,commit=60)\n/dev/mapper/mmcblk0p2_crypt on /boot type ext4 (rw,noatime,commit=60)\n/dev/mapper/mmcblk0p2_crypt on /usr type ext4 (ro,noatime,commit=60)\ntmpfs on /dev/shm type tmpfs (rw,nosuid,nodev)\n/dev/mapper/mmcblk0p2_crypt on /var type ext4 (rw,noatime,commit=60)\ntmpfs on /tmp type tmpfs (rw,nosuid,nodev,size=989180k,nr_inodes=1048576)\ntmpfs on /var/volatile type tmpfs (rw,relatime)\ntmpfs on /sysroot/ostree/deploy/lmp/var/volatile type tmpfs (rw,relatime)\n/dev/mmcblk0p1 on /var/rootdirs/mnt/boot type vfat (rw,noatime,sync,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro)\ntmpfs on /run/user/1000 type tmpfs (rw,nosuid,nodev,relatime,size=197832k,nr_inodes=49458,mode=700,uid=1000,gid=1000)\n\nRoot filesystem is OSTree managed (read-only base with writable overlay)\nCould not determine mount status for /bin\nCould not determine mount status for /sbin\nCould not determine mount status for /lib\nCould not determine mount status for /lib64\nBoot partition is read-write (may be needed for OTA updates)\nDetected Foundries.io Linux Micro Platform\nOSTree version: libostree:\n Version: '2021.6'\n Git: v2021.6\n Features:\n  - libcurl\n  - ex-fsverity\n  - libarchive\n  - libmount\n  - systemd\n  - release\n  - p2p\nPersistent data areas found in /var\nWrite protection verified on /usr\nRead-only mounts: [\"/ (OSTree managed - RW overlay over RO base)\", \"/usr\", \"/boot (RW for OTA updates)\", \"OSTree managed filesystem\", \"/usr (write-protected)\"]\nWritable areas: [\"/var\", \"/tmp\"]",
      "duration": {
        "secs": 1,
        "nanos": 864436432
      },
      "timestamp": "2025-10-07T08:57:28.449770951Z",
      "metadata": {}
    },
    {
      "test_id": "runtime_003",
      "test_name": "SELinux Status",
      "category": "runtime",
      "status": "Skipped",
      "message": "SELinux not available on this system",
      "details": null,
      "duration": {
        "secs": 0,
        "nanos": 230369099
      },
      "timestamp": "2025-10-07T08:57:28.680145233Z",
      "metadata": {}
    },
    {
      "test_id": "runtime_005",
      "test_name": "User Permission Security",
      "category": "runtime",
      "status": "Passed",
      "message": "User permissions secure (root login disabled)",
      "details": "Root users (UID 0): none detected\nRoot user exists: yes\nShell users count: 1\nCurrent user: fio (default Foundries.io user)\nUsing 'fio' user (appears to be customized)\nCurrent user groups: sudo audio plugdev users docker fio\nRoot user: exists but not in passwd file (possibly managed by system)\nRoot shell (via getent): /sbin/nologin (login disabled)\nSudo config: no custom sudoers files found",
      "duration": {
        "secs": 1,
        "nanos": 789578487
      },
      "timestamp": "2025-10-07T08:57:30.469728196Z",
      "metadata": {}
    },
    {
      "test_id": "runtime_004",
      "test_name": "SSH Security Configuration",
      "category": "runtime",
      "status": "Failed",
      "message": "SSH critical security issues: Root login permitted - this is a critical security vulnerability",
      "details": "SSH Config:\nPermitRootLogin yes\n\nGood: [\"SSH Protocol 2 (secure)\"]\nIssues: [\"Root login permitted\", \"Unable to verify SSH algorithm configuration\"]",
      "duration": {
        "secs": 0,
        "nanos": 294048611
      },
      "timestamp": "2025-10-07T08:57:30.763781602Z",
      "metadata": {}
    },
    {
      "test_id": "runtime_001",
      "test_name": "Filesystem Encryption (LUKS)",
      "category": "runtime",
      "status": "Passed",
      "message": "LUKS filesystem encryption detected",
      "details": "LUKS devices: \nDevice mapper: total 0\ndrwxr-xr-x  2 root root      80 Apr 28  2022 .\ndrwxr-xr-x 13 root root    3620 Apr 28  2022 ..\nlrwxrwxrwx  1 root root       7 Apr 28  2022 mmcblk0p2_crypt -> ../dm-0\n\nEncrypted mounts: /dev/mapper/mmcblk0p2_crypt on /sysroot type ext4 (rw,noatime,commit=60)\n/dev/mapper/mmcblk0p2_crypt on / type ext4 (rw,noatime,commit=60)\n/dev/mapper/mmcblk0p2_crypt on /boot type ext4 (rw,noatime,commit=60)\n/dev/mapper/mmcblk0p2_crypt on /usr type ext4 (ro,noatime,commit=60)\n/dev/mapper/mmcblk0p2_crypt on /var type ext4 (rw,noatime,commit=60)\n",
      "duration": {
        "secs": 0,
        "nanos": 313283807
      },
      "timestamp": "2025-10-07T08:57:31.077115110Z",
      "metadata": {}
    },
    {
      "test_id": "runtime_002",
      "test_name": "Firewall Configuration",
      "category": "runtime",
      "status": "Warning",
      "message": "iptables available but unable to read rules",
      "details": "iptables rules:\n\nNetfilter modules: nf_conntrack_netlink    45056  0\nnfnetlink              20480  2 nf_conntrack_netlink\niptable_nat            16384  1\nnf_nat                 40960  2 iptable_nat,xt_MASQUERADE\nbr_netfilter           32768  0\nbridge                184320  1 br_netfilter\nnf_conntrack          131072  5 xt_conntrack,nf_nat,xt_state,nf_conntrack_netlink,xt_MASQUERADE\nnf_defrag_ipv6         24576  1 nf_conntrack\nnf_defrag_ipv4         16384  1 nf_conntrack\niptable_filter         16384  1\nip_tables              32768  2 iptable_filter,iptable_nat\nx_tables               36864  8 xt_conntrack,iptable_filter,xt_state,xt_tcpudp,xt_addrtype,ip_tables,iptable_nat,xt_MASQUERADE\n\niptables binary available: true\nUsed sudo to access iptables rules",
      "duration": {
        "secs": 0,
        "nanos": 740590557
      },
      "timestamp": "2025-10-07T08:57:31.817710699Z",
      "metadata": {}
    },
    {
      "test_id": "runtime_006",
      "test_name": "Service Hardening",
      "category": "runtime",
      "status": "Passed",
      "message": "Service hardening looks good",
      "details": "Running services: 17\nRisky services: []",
      "duration": {
        "secs": 0,
        "nanos": 94946913
      },
      "timestamp": "2025-10-07T08:57:31.912663097Z",
      "metadata": {}
    },
    {
      "test_id": "runtime_007",
      "test_name": "Kernel Security Protections",
      "category": "runtime",
      "status": "Warning",
      "message": "Some kernel protections active: [\"ASLR\"]",
      "details": "ASLR: 2\nNX support: false\nKPTR_RESTRICT: 0\nDMESG_RESTRICT: 0",
      "duration": {
        "secs": 0,
        "nanos": 296214892
      },
      "timestamp": "2025-10-07T08:57:32.208882441Z",
      "metadata": {}
    }
  ]
}
2025-10-07T08:57:32.208967Z ERROR security_compliance_cli: ❌ Security compliance tests FAILED
